<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">



<mapper namespace="mapper.photo2">
	
	<!-- id=plike -->
	<insert id="plike" parameterType="map">
		INSERT INTO H_LIKE VALUES('L_'||H_LIKE_SEQUENCE.nextval,#{email},#{pno},'1')
	
	</insert>
	
	
	<!-- id=nickname -->
	<select	id="nickname" parameterType="java.lang.String" resultType="java.lang.String">
		SELECT EMAIL FROM H_MEMBER WHERE NICKNAME=#{NICKNAME}
	
	</select>
	
	
	<!-- id=reviewpage -->
	<select id="reviewpage" resultType="com.myhouse.vo.goodsVO">
		SELECT ODS.GNO,IOR.INO,DER.EMAIL,COMPANY,ITITLE,GOODS_SIMAGE,GOODS_PRICE,OSTATUS 
		FROM H_GOODS ODS, H_INTERIOR IOR, H_ORDER DER 
		WHERE DER.EMAIL='alstndkrl@naver.com' AND IOR.INO=ODS.INO AND ODS.GNO=DER.GNO AND OSTATUS='1'
	
	
	</select>
	
	
	
	
	<!-- id=qna -->
	<select id="qna" resultType="com.myhouse.vo.questionVO">
		SELECT * FROM(SELECT DISTINCT QNO,IOR.INO,ODS.GNO,QTYPE,QCONTENT,QREPLY,GOODS_SIMAGE,QSTATUS,QDATE,QDATE_R 
		FROM H_QUESTION TION, H_MEMBER MEM, H_INTERIOR IOR,H_GOODS ODS WHERE IOR.INO=ODS.INO AND ODS.GNO=TION.GNO 
		AND IOR.EMAIL='alstndkrl@naver.com')
		WHERE QSTATUS='1' ORDER BY QDATE DESC
	
	</select>



	<!-- id=questlist -->
	<select id="questlist" resultType="com.myhouse.vo.questionVO">
		SELECT QNO,EMAIL,GNO,QTYPE,QCONTENT,QSTATUS,QDATE FROM 
		(SELECT QNO,MEM.EMAIL,TION.GNO,QTYPE,QCONTENT,QSTATUS,QDATE FROM H_QUESTION TION,
		 H_MEMBER MEM, H_GOODS ODS WHERE ODS.GNO=TION.GNO AND MEM.EMAIL='alstndkrl@naver.com')
		 WHERE QSTATUS='1' ORDER BY QDATE DESC	
	</select>


	<!-- id=passchange  -->
	<update id="passchange" parameterType="com.myhouse.vo.MemberVO">
		UPDATE H_MEMBER SET PASS=#{pass} WHERE EMAIL='alstndkrl@naver.com'
	</update>
	
	
	<!-- id=review(최신순) -->
	<select id="review1" resultType="com.myhouse.vo.reviewVO">
		SELECT INO,GNO,EMAIL,STAR,COMPANY,ITITLE,INTERIOR_SIMAGE,VDATE,VCONTENT 
		FROM(SELECT IOR.INO,ODS.GNO,VIE.EMAIL,STAR,COMPANY,IOR.INTERIOR_SIMAGE,ITITLE,
		TO_CHAR(VDATE,'YY.MM.DD') VDATE,VCONTENT FROM H_REVIEW VIE, H_GOODS ODS, H_INTERIOR 
		IOR WHERE ODS.GNO=VIE.GNO AND IOR.INO=ODS.INO)
		WHERE EMAIL='alstndkrl@naver.com' ORDER BY VDATE DESC
		
	</select>



	<!-- id=review(베스트순) -->
	<select id="review" resultType="com.myhouse.vo.reviewVO">
		SELECT INO,GNO,EMAIL,STAR,COMPANY,ITITLE,INTERIOR_SIMAGE,VDATE,VCONTENT 
		FROM(SELECT IOR.INO,ODS.GNO,VIE.EMAIL,STAR,COMPANY,IOR.INTERIOR_SIMAGE,
		ITITLE,TO_CHAR(VDATE,'YY.MM.DD') VDATE,VCONTENT FROM H_REVIEW VIE, H_GOODS ODS, 
		H_INTERIOR IOR WHERE ODS.GNO=VIE.GNO AND IOR.INO=ODS.INO)
		WHERE EMAIL='alstndkrl@naver.com' ORDER BY STAR DESC
	</select>





	<!-- id=update  -->
	<update id="update" parameterType="com.myhouse.vo.MemberVO">
		UPDATE H_MEMBER SET 
		NICKNAME=#{nickname} ,HOMEPAGE=#{homepage} 
		,GENDER=#{gender} , BIRTH=#{birth} , INTRO=#{intro} 
			<if test="member_image != null">
				,MEMBER_IMAGE=#{member_image}, MEMBER_SPIMAGE=#{member_spimage}
			</if>
		WHERE EMAIL='alstndkrl@naver.com'
	</update>


	<!-- id=option -->
	<select id="option" resultType="com.myhouse.vo.MemberVO">
		SELECT EMAIL,NICKNAME,HOMEPAGE,GENDER,BIRTH,MEMBER_SPIMAGE,INTRO FROM H_MEMBER WHERE EMAIL='alstndkrl@naver.com'
	</select>



	<!-- id=orderlist -->
	<select id="orderlist" resultType="com.myhouse.vo.interiorVO">
		SELECT * FROM(SELECT ONO,IOR.INO,ODS.GNO, DER.EMAIL,OSTATUS,OCOUNT, COMPANY,ITITLE,INTERIOR_SIMAGE,TO_CHAR(IDATE,'YY.MM.DD') IDATE,SEASON,COLOR,PRICE 
		FROM H_INTERIOR IOR,H_GOODS ODS,H_ORDER DER WHERE ODS.GNO=DER.GNO AND IOR.INO=ODS.INO AND OSTATUS='1' AND DER.EMAIL='alstndkrl@naver.com')ORDER BY INO DESC
	</select>




	<!-- id=likelist -->
	<select id="likelist" resultType="com.myhouse.vo.PhotoVO"> 
		SELECT DISTINCT LIK.EMAIL,PHO.PNO,PHOTO_SIMAGE,PHOTO_LIKE 
		FROM H_PHOTO PHO, H_MEMBER MEM, H_LIKE LIK WHERE PHOTO_LIKE='1' AND PHO.PNO=LIK.PNO AND LIK.EMAIL='alstndkrl@naver.com' ORDER BY PNO DESC
	</select>



	<!-- id=profile  -->
	<select id="profile" resultType="com.myhouse.vo.MemberVO">
		SELECT DISTINCT EMAIL, NICKNAME,MEMBER_IMAGE,MEMBER_SPIMAGE,FOLLOWER,FOLLOWING 
		FROM(SELECT PNO, MEM.EMAIL, NICKNAME,MEMBER_IMAGE,MEMBER_SPIMAGE,FOLLOWER,FOLLOWING 
		FROM H_PHOTO PHO, H_MEMBER MEM WHERE PHO.EMAIL=MEM.EMAIL)
		WHERE EMAIL='alstndkrl@naver.com'
	</select>


	<!-- id=picture  -->
	<select id="picture" resultType="com.myhouse.vo.PhotoVO">
		SELECT PNO,EMAIL, PCONTENT, PHOTO_SIMAGE,PHITS FROM H_PHOTO WHERE EMAIL='alstndkrl@naver.com' ORDER BY PDATE
	</select>
		

	<!-- id=photocount -->
	<select id="photocount" resultType="int">
		SELECT COUNT(*) FROM H_PHOTO WHERE EMAIL='alstndkrl@naver.com'
	</select>

	
	<!-- id=likecount  -->
	<select id="likecount" resultType="int">
		SELECT COUNT(*) FROM 
		(SELECT DISTINCT LIK.EMAIL,PHO.PNO,PHOTO_SIMAGE,PHOTO_LIKE FROM H_PHOTO PHO,
		 H_MEMBER MEM, H_LIKE LIK WHERE PHOTO_LIKE='1' AND PHO.PNO=LIK.PNO 
		 AND LIK.EMAIL='alstndkrl@naver.com' ORDER BY PNO DESC)
	
	
	</select>


	<!-- id=photolist -->
	<select id="photolist" resultType="com.myhouse.vo.PhotoVO">
		SELECT PNO,EMAIL,PHOTO_SIMAGE FROM H_PHOTO WHERE EMAIL='alstndkrl@naver.com' ORDER BY PDATE
	</select>




</mapper>



